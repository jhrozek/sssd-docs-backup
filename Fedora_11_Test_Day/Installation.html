<html><head><link rel="stylesheet" href="/sssd-test2/trac.css" type="text/css" /><link rel="stylesheet" href="/sssd-test2/wiki.css" type="text/css" /></head><body><p>
</p><div class="wiki-toc">
<ol>
  <li>
    <ol>
      <li>
        <a href="#InstallationInstructions">Installation Instructions</a>
      </li>
    </ol>
  </li>
</ol>
</div><p>
</p>
<h2 id="InstallationInstructions">Installation Instructions</h2>
<ol><li>Install the sssd package and its dependencies. You can skip this step if you are using the Test Day LiveCD.
<pre class="wiki">yum install sssd
</pre></li><li>Copy <a class="attachment" href="https://fedorahosted.org/sssd/attachment/wiki/Fedora_11_Test_Day/sssd.conf" title="Attachment 'sssd.conf' in Fedora_11_Test_Day">sssd.conf</a><a class="trac-rawlink" href="https://fedorahosted.org/sssd/raw-attachment/wiki/Fedora_11_Test_Day/sssd.conf" title="Download">​</a> to /etc/sssd/sssd.conf
</li><li>Configure access to the Test Day LDAP server
<ol><li>Verify connectivity to the LDAP server
<pre class="wiki">ping rawhide1.fedoraproject.org
</pre>If you get a ping response, all is well.
</li><li>Launch system-config-authentication (or select System-&gt;Administration-&gt;Authentication from the menu)
</li><li>In the User Information tab, check <tt>Enable LDAP Support</tt> and then choose <tt>Configure LDAP</tt>
</li><li>Leave the <tt>Use TLS to encrypt connections</tt> checkbox unchecked.
</li><li>Enter <tt>dc=fedoraproject, dc=org</tt> in the the <tt>LDAP Search Base DN</tt> field.
</li><li>Enter <tt>ldap://rawhide1.fedoraproject.org</tt> in the <tt>LDAP Server</tt> field.
</li><li>Choose "OK" twice.
</li><li>Relaunch system-config-authentication and uncheck <tt>Enable LDAP Support</tt>, then hit OK once more
We do this to ease the configuration of the ldap.conf file, but then we disable it in favor of using the SSSD.
</li></ol></li><li>Enable the use of the SSSD in nsswitch.conf. Change the following lines of /etc/nsswitch.conf from:
<pre class="wiki">passwd:     files ldap
shadow:     files ldap
group:      files ldap
</pre>to
<pre class="wiki">passwd:     files sss
shadow:     files
group:      files sss
</pre>Please note that your <tt>/etc/nsswitch.conf</tt> may have different contents for passwd:, shadow: and group: databases if you had User Identity information configured differently. The desired state is to have <tt>files sss</tt> set for passwd: and group: databases for the tests.
</li><li>Enable the use of the SSSD for PAM. Change the following lines of /etc/pam.d/system-auth from:
If you are changing the default PAM config on Fedora, it should look like:
<pre class="wiki">#%PAM-1.0
auth        required      pam_env.so
auth        sufficient    pam_fprintd.so
auth        sufficient    pam_unix.so nullok
auth        sufficient    pam_sss.so use_first_pass
auth        requisite     pam_succeed_if.so uid &gt;= 500 quiet
auth        required      pam_deny.so

account     sufficient    pam_unix.so
account     required      pam_sss.so
account     sufficient    pam_localuser.so
account     sufficient    pam_succeed_if.so uid &lt; 500 quiet
account     required      pam_permit.so

password    requisite     pam_cracklib.so try_first_pass retry=3
password    sufficient    pam_unix.so sha512 shadow nullok use_authtok
password    sufficient    pam_sss.so use_first_pass
password    required      pam_deny.so

session     optional      pam_keyinit.so revoke
session     required      pam_limits.so
session     [success=1 default=ignore] pam_succeed_if.so service in crond quiet use_uid
session     sufficient    pam_unix.so
session     required      pam_sss.so
</pre>If you are using a custom <tt>system-auth</tt> file, please adjust accordingly.
</li><li>Prepare the legacy authentication for LDAP. Create the file /etc/pam.d/sssdproxyldap with the following contents
<pre class="wiki">#%PAM-1.0
auth required pam_ldap.so
session required pam_ldap.so
account required pam_ldap.so
password required pam_ldap.so
</pre></li><li>Prepare legacy authentication for native users. Create the file /etc/pam.d/sssdproxylocal
<pre class="wiki">#%PAM-1.0
auth        required      pam_env.so
auth        sufficient    pam_fprintd.so
auth        sufficient    pam_unix.so nullok
auth        requisite     pam_succeed_if.so uid &gt;= 500 quiet
auth        required      pam_deny.so

account     sufficient    pam_unix.so
account     sufficient    pam_localuser.so
account     sufficient    pam_succeed_if.so uid &lt; 500 quiet
account     required      pam_permit.so

password    requisite     pam_cracklib.so try_first_pass retry=3
password    sufficient    pam_unix.so sha512 shadow nullok use_authtok
password    required      pam_deny.so

session     optional      pam_keyinit.so revoke
session     required      pam_limits.so
session     [success=1 default=ignore] pam_succeed_if.so service in crond quiet use_uid
session     sufficient    pam_unix.so
</pre></li><li>Turn off the Name Service Cache Daemon. SSSD provides its own caching mechanisms which may not interact with nscd's very well
<pre class="wiki">service nscd stop
</pre></li><li>There are still issues with SELinux interaction as of Fedora 11 Beta. To mitigate any possible SELinux denials, turn it into 'Permissive' state for the test (as root):
<pre class="wiki">setenforce 0
</pre>Please <a class="ext-link" href="https://fedorahosted.org/sssd/newticket"><span class="icon">​</span>report</a> any SELinux denials seen in setroubleshoot so we can fix them.
</li><li>Restart the SSSD service (as root):
<pre class="wiki">service sssd restart
</pre>(Please disregard the "<tt>Unable to register control with rootdse!</tt>" messages, as they are erroneous.)
</li><li>Verify that the SSSD services are running:
<pre class="wiki">ps -e |grep sss
</pre>You should see:
<pre class="wiki">30968 pts/0    00:00:00 sssd
30970 pts/0    00:00:00 sssd_dp
30972 pts/0    00:00:00 sssd_be
30973 pts/0    00:00:00 sssd_be
30974 pts/0    00:00:00 sssd_be
30975 pts/0    00:00:00 sssd_nss
30976 pts/0    00:00:00 sssd_pam
</pre></li></ol></body></html>