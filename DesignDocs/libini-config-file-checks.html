<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Feature Name &#8212; sssd 1.15.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.15.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="feature-name">
<h1>Feature Name<a class="headerlink" href="#feature-name" title="Permalink to this headline">¶</a></h1>
<p>Config file validation</p>
<p>Related ticket(s):</p>
<ul class="simple">
<li><a class="reference external" href="https://fedorahosted.org/sssd/ticket/2269">​https://fedorahosted.org/sssd/ticket/2269</a></li>
<li><a class="reference external" href="https://fedorahosted.org/sssd/ticket/133">​https://fedorahosted.org/sssd/ticket/133</a></li>
</ul>
<div class="section" id="problem-statement">
<h2>Problem statement<a class="headerlink" href="#problem-statement" title="Permalink to this headline">¶</a></h2>
<p>Typos in option names are not detected. If conflicting options are used
or required options are missing, SSSD should produce easy to understand
error/debug message so that administrators can fix the problem easier.</p>
</div>
<div class="section" id="overview-of-the-solution">
<h2>Overview of the solution<a class="headerlink" href="#overview-of-the-solution" title="Permalink to this headline">¶</a></h2>
<p>Application developers that use libini from Ding libs will be able to
specify constraints that the configuration must respect. These
constraints will be written using INI format in form of rules. Each rule
will use one validator. The validator can be internal (provided by
libini) or external (provided by applications). The rules will be
written in a separate file and their usage will be optional. Validators
will generate errors in form of strings that should be readable for
users. Applications that use libini will then be able to write these
strings somewhere appropriate (for example log files or stderr).</p>
</div>
<div class="section" id="format-of-rules">
<h2>Format of rules<a class="headerlink" href="#format-of-rules" title="Permalink to this headline">¶</a></h2>
<p>Each rule needs to specify validator that will be used, other parameters
depend on the validator. Some validators may not require any additional
parameters.</p>
</div>
<div class="section" id="using-the-rules">
<h2>Using the rules<a class="headerlink" href="#using-the-rules" title="Permalink to this headline">¶</a></h2>
<p>The rules are used from applications in the following way:</p>
<ol class="arabic simple">
<li>rules are loaded from file using the function
<code class="docutils literal"><span class="pre">int</span> <span class="pre">ini_read_rules_from_file(const</span> <span class="pre">char</span> <span class="pre">*filename,</span> <span class="pre">struct</span> <span class="pre">ini_cfgobj</span> <span class="pre">**_rules_obj);</span></code></li>
<li>rules and configuration are passed as two fist parameters to the
function</li>
</ol>
<p>The last parameter is special structure used to hold all errors
generated by the validators. libini will provide API to create, destroy,
read errors from and write errors into this structure. The
extra_validators and num_extra validators are used to specify external
validators (see section &#8216;External validators&#8217; below).</p>
</div>
<div class="section" id="internal-validators">
<h2>Internal validators<a class="headerlink" href="#internal-validators" title="Permalink to this headline">¶</a></h2>
<p>Internal validators will be simple validators that may be used by
projects outside SSSD. More complicated and application specific
validators will be written as external validators. First two internal
validators will be ini_allowed_options and ini_allowed_sections.</p>
<div class="section" id="validator-ini-allowed-options">
<h3>Validator ini_allowed_options<a class="headerlink" href="#validator-ini-allowed-options" title="Permalink to this headline">¶</a></h3>
<p>Example:</p>
<p>The rule above uses the ini_allowed_option validator and enumerates
all allowed options for sections with names that match regular
expression <sup>foo$. The options allowed here are foo, bar and baz.
Config file like this</sup></p>
<p>will generate no errors, because all options in section foo are allowed.
Config file</p>
<p>will result in errors being generated because there is an unknown option
baaaar used in section foo.</p>
<p>The ini_allowed_options validator controls only sections that match
regular expression specified in section_re. Other sections are ignored
by the validator.</p>
</div>
<div class="section" id="validator-ini-allowed-sections">
<h3>Validator ini_allowed_sections<a class="headerlink" href="#validator-ini-allowed-sections" title="Permalink to this headline">¶</a></h3>
<p>This validator is used to enumerate all allowed sections. The format is
following.</p>
<p>The validator will generate error if the config file contains section
that is not matched by any of the regular expressions specified by one
of the section_re parameters.</p>
</div>
</div>
<div class="section" id="external-validators">
<h2>External validators<a class="headerlink" href="#external-validators" title="Permalink to this headline">¶</a></h2>
<p>External validators are specified using following structures:</p>
<p>The name attribute is sting that is used inside rules in the validator
parameter. The func attribute is pointer to function of type
ini_validator_func which is defined using typedef as following:</p>
<p>This function has following parameters:</p>
<ul class="simple">
<li>rule_name - this is name of rule that uses this validator (for
example &#8220;rule/myrule&#8221;)</li>
<li>rules_obj - this is config object with all the rules</li>
<li>config_obj - this is config object with the actual configuration
that is being checked by the rules</li>
<li>errobj - this ini_errobj structure used to propagate errors</li>
</ul>
<p>Users of libini can specify array of struct ini_validator structures
and pass them to ini_rules_check() function. After this they can be
used in the same way as internal validators.</p>
</div>
<div class="section" id="configuration-changes">
<h2>Configuration changes<a class="headerlink" href="#configuration-changes" title="Permalink to this headline">¶</a></h2>
<p>In order to take advantage of this feature in SSSD the constraint file
will have to be created.</p>
</div>
<div class="section" id="how-to-test">
<h2>How To Test<a class="headerlink" href="#how-to-test" title="Permalink to this headline">¶</a></h2>
<p>Unit tests in Ding libs. Integration and unit tests for SSSD.</p>
</div>
<div class="section" id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h2>
<p>Michal Židek <a class="reference external" href="mailto:mzidek&#37;&#52;&#48;redhat&#46;com">​mzidek<span>&#64;</span>redhat<span>&#46;</span>com</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Feature Name</a><ul>
<li><a class="reference internal" href="#problem-statement">Problem statement</a></li>
<li><a class="reference internal" href="#overview-of-the-solution">Overview of the solution</a></li>
<li><a class="reference internal" href="#format-of-rules">Format of rules</a></li>
<li><a class="reference internal" href="#using-the-rules">Using the rules</a></li>
<li><a class="reference internal" href="#internal-validators">Internal validators</a><ul>
<li><a class="reference internal" href="#validator-ini-allowed-options">Validator ini_allowed_options</a></li>
<li><a class="reference internal" href="#validator-ini-allowed-sections">Validator ini_allowed_sections</a></li>
</ul>
</li>
<li><a class="reference internal" href="#external-validators">External validators</a></li>
<li><a class="reference internal" href="#configuration-changes">Configuration changes</a></li>
<li><a class="reference internal" href="#how-to-test">How To Test</a></li>
<li><a class="reference internal" href="#authors">Authors</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/DesignDocs/libini-config-file-checks.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Red Hat.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="../_sources/DesignDocs/libini-config-file-checks.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>