<html><head><link rel="stylesheet" href="/sssd-test2/trac.css" type="text/css" /><link rel="stylesheet" href="/sssd-test2/wiki.css" type="text/css" /></head><body><h1 id="D-BusInterface:UsersandGroups">D-Bus Interface: Users and Groups</h1>
<p>
Related ticket(s):
</p>
<ul><li><a class="ext-link" href="https://fedorahosted.org/sssd/ticket/2150"><span class="icon">​</span>https://fedorahosted.org/sssd/ticket/2150</a>
</li></ul><p>
Related design page(s):
</p>
<ul><li><a class="ext-link" href="https://docs.pagure.org/sssd-test2/DesignDocs/DBusResponder.html"><span class="icon">​</span>https://fedorahosted.org/sssd/wiki/DesignDocs/DBusResponder</a>
</li></ul><h3 id="Problemstatement">Problem statement</h3>
<p>
This design document describes how users and groups are represented on SSSD D-Bus interface.
</p>
<h3 id="Usecases">Use cases</h3>
<ul><li>Listing users and groups in access control GUI
</li><li>Obtaining extra information about user that is not available through standard APIs
</li></ul><h2 id="D-BusInterface">D-Bus Interface</h2>
<h3 id="org.freedesktop.sssd.infopipe.Users">org.freedesktop.sssd.infopipe.Users</h3>
<h4 id="Objectpathsimplementingthisinterface">Object paths implementing this interface</h4>
<ul><li>/org/freedesktop/sssd/infopipe/Users
</li></ul><h4 id="Methods">Methods</h4>
<ul><li>o FindByName(s:name)
</li><li>o FindByID(u:id)
</li><li>ao ListByName(s:filter, u:limit)
<ul><li>filter: possible asterisk as wildcard character; minimum length is required
</li><li>limit: maximum number of entries returned, 0 means unlimited or to maximum allowed number
</li></ul></li><li>ao ListByDomainAndName(s:domain_name, s:filter, u:limit)
<ul><li>filter: possible asterisk as wildcard character; minimum length is required
</li><li>limit: maximum number of entries returned, 0 means unlimited or to maximum allowed number
</li></ul></li></ul><h4 id="Signals">Signals</h4>
<p>
None.
</p>
<h4 id="Properties">Properties</h4>
<p>
None.
</p>
<h3 id="org.freedesktop.sssd.infopipe.Users.User">org.freedesktop.sssd.infopipe.Users.User</h3>
<h4 id="Objectpathsimplementingthisinterface1">Object paths implementing this interface</h4>
<ul><li>/org/freedesktop/sssd/infopipe/Users/$DOMAIN/$UID
</li></ul><h4 id="Methods1">Methods</h4>
<ul><li>void UpdateGroupsList()
<ul><li>Performs initgroups on the user.
</li></ul></li></ul><h4 id="Signals1">Signals</h4>
<p>
None.
</p>
<h4 id="Properties1">Properties</h4>
<ul><li>s name
<ul><li>The user's login name.
</li></ul></li><li>u uidNumber
<ul><li>The user's UID.
</li></ul></li><li>u gidNumber
<ul><li>The user's primary GID.
</li></ul></li><li>s gecos
<ul><li>The user's real name.
</li></ul></li><li>s homeDirectory
<ul><li>The user's home directory
</li></ul></li><li>s loginShell
<ul><li>The user's login shell
</li></ul></li><li>a{sas} extraAttributes
<ul><li>Extra attributes as configured by the SSSD. The key is the attribute name, value is array of strings that contains the values.
</li></ul></li><li>ao groups
<ul><li>An array of object paths representing the groups the user is a member of.
</li></ul></li></ul><h3 id="org.freedesktop.sssd.infopipe.Groups">org.freedesktop.sssd.infopipe.Groups</h3>
<h4 id="Objectpathsimplementingthisinterface2">Object paths implementing this interface</h4>
<ul><li>/org/freedesktop/sssd/infopipe/Groups
</li></ul><h4 id="Methods2">Methods</h4>
<ul><li>o FindByName(s:name)
</li><li>o FindByID(u:id)
</li><li>ao ListByName(s:filter, u:limit)
<ul><li>filter: possible asterisk as wildcard character; minimum length is required
</li><li>limit: maximum number of entries returned, 0 means unlimited or to maximum allowed number
</li></ul></li><li>ao ListByDomainAndName(s:domain_name, s:filter, u:limit)
<ul><li>filter: possible asterisk as wildcard character; minimum length is required
</li><li>limit: maximum number of entries returned, 0 means unlimited or to maximum allowed number
</li></ul></li></ul><h4 id="Signals2">Signals</h4>
<p>
None.
</p>
<h4 id="Properties2">Properties</h4>
<h3 id="org.freedesktop.sssd.infopipe.Groups.Group">org.freedesktop.sssd.infopipe.Groups.Group</h3>
<h4 id="Objectpathsimplementingthisinterface3">Object paths implementing this interface</h4>
<ul><li>/org/freedesktop/sssd/infopipe/Groups/$DOMAIN/$GID
</li></ul><h4 id="Methods3">Methods</h4>
<p>
None.
</p>
<h4 id="Signals3">Signals</h4>
<p>
None.
</p>
<h4 id="Properties3">Properties</h4>
<ul><li>s name
<ul><li>The group's name.
</li></ul></li><li>u gidNumber
<ul><li>The groups's primary GID.
</li></ul></li><li>ao users
<ul><li>A list of the group's member user objects. 
</li></ul></li><li>ao groups
<ul><li>A list of the group's member group objects.
</li></ul></li></ul><h3 id="Overviewofthesolution">Overview of the solution</h3>
<p>
New D-Bus interfaces will be implemented in the IFP responder.
</p>
<p>
Find methods perform online lookup if the entry is missing or expired.
</p>
<p>
Listing methods always perform online lookup to ensure that even recently added entries are in the list.
</p>
<p>
Listing methods can return only a limited number of entries. Number of entries returned can be controlled by  <strong>limit</strong> parameter with hard limit set in sssd.conf with a new configuration option <strong>filter_limit</strong>. This option can be present in [ifp] and [domain] sections to set this limit for data provider filter searches ([domain] section) and also global hard limit for the listing methods itself ([ifp] section). This limit is supposed to improve performace with large databases so we process only a small number of records. If the option is set to 0, the limit is disabled.
</p>
<p>
Filter may contain only '*' asterisk as a wildcard character, it does not support complete set of regular expressions. The asterisk can be present on the beginning of the filter '*filter', its end 'filter*', both sides '*filter*' or even in the middle '*fil*ter*', since it is supported by both LDAP and LDB. However, only prefix-filter ('filter*'), can take the performace boost from indices so other filter may not perform so good with huge databases.
</p>
<h3 id="Configurationchanges">Configuration changes</h3>
<p>
The following options will be created in the [ifp] and [domain] sections:
</p>
<ul><li>wildcard_search_limit (uint32)
</li></ul><p>
See the <a class="missing wiki" href="https://docs.pagure.org/sssd-test2/WildcardRefresh.html" rel="nofollow">wildcard refresh design page?</a> for more details.
</p>
<h3 id="HowToTest">How To Test</h3>
<p>
Call the D-Bus methods and properties. For example with <strong>dbus-send</strong> tool.
</p>
<h3 id="Authors">Authors</h3>
<ul><li>Jakub Hrozek &lt;<a class="mail-link" href="mailto:jhrozek@redhat.com"><span class="icon">​</span>jhrozek@redhat.com</a>&gt;
</li><li>Pavel Březina &lt;<a class="mail-link" href="mailto:pbrezina@redhat.com"><span class="icon">​</span>pbrezina@redhat.com</a>&gt;
</li></ul></body></html>