<html><head><link rel="stylesheet" href="/sssd-test2/trac.css" type="text/css" /><link rel="stylesheet" href="/sssd-test2/wiki.css" type="text/css" /></head><body><h2 id="UserAccountManagementConsolidation">User Account Management Consolidation</h2>
<p>
Related ticket(s):
</p>
<ul><li>N/A
</li></ul><p>
The following proposal is the result of the understanding reached at the February 22nd, 2013  meeting held at the Red Hat offices in Brno.
</p>
<h3 id="ProblemStatement">Problem Statement</h3>
<p>
User management is currently fragmented throughout our system. The only unifying interface is nsswitch, provided by glibc. However, this interface is minimal, provides only POSIX information and is a querying interface only.
</p>
<p>
An interface used for limited editing of account data is provided through libuser. This library can be used to modify data in local files or LDAP servers. However the libuser interface is not generic and does not allow to dynamically select the target database nor add additional user data.
</p>
<p>
Desktop tools augment user information by storing additional data in a separate database.
</p>
<h3 id="Legacyaspectsofusermanagement">Legacy aspects of user management</h3>
<h4 id="Localfiles">Local files</h4>
<p>
Even today, many tools may still have direct dependencies on the files even tough the <a class="ext-link" href="https://www.gnu.org/software/libc/manual/html_node/Name-Service-Switch.html"><span class="icon">​</span>nsswitch</a> interface has been around for a long time. Also some administrators are used to vipw password files or use scripts that directly manipulate them.  For these reasons it is not advisable to stop using the traditional files for local accounts completely.
</p>
<p>
The only option to augment the files with non-POSIX information is to access them through a common interface and store additional information in a separate database. Legacy files would still remain authoritative.
</p>
<h4 id="Managingremoteaccounts">Managing remote accounts</h4>
<p>
For accessing remote information, nsswitch became the de facto standard. Red Hat is standardizing on the SSSD daemon for accessing remote user information and perform authentication for remote users.
</p>
<p>
Remote directories often provide more flexibility, so additional data will pushed there when possible. However in some cases additional information may need to be stored locally if the remote server can't hold it. The directory remains authoritative.
</p>
<h3 id="UnifiedinterfacethroughSSSD">Unified interface through SSSD</h3>
<p>
The proposal is to leverage SSSD to unify account management. The pros and cons of this approach are listed below:
</p>
<ul><li>Pros:
<ul><li>Provides all the infrastructure needed to cache remote data and to store locally additional information.
</li><li>SSSD's database is easily extensible (LDAP -like)
</li><li>Already provide PAM and nsswitch interfaces
</li></ul></li><li>Cons:
<ul><li>Misses an interface to directly manage users, however already has infrastructure in place to make it easy to build this interface.
</li></ul></li></ul><h4 id="Changingauthenticationanduserlookup">Changing authentication and user lookup</h4>
<p>
The system will continue to use the classic PAM and nsswitch interfaces for authentication and account lookups.
</p>
<p>
However we will probably change the PAM stack to try pam_sss before pam_unix so that sssd is consulted first and pam_unix is only used as a fallback to directly access files.
</p>
<p>
Similarly for the nsswitch interface we will probably switch passwd and group (and potentially other) database to use the sss target first and only later fall back to the files target
</p>
<h3 id="ActionItems">Action Items</h3>
<ul><li>Develop dbus interface specification to satisfy desktop requirements (design doc for SSSD)
</li><li>Open tickets in SSSD to:
<ul><li>Build Files provider in SSSD
</li><li>Build Rich API/dbus responder
</li><li>Insure additional information pins cache contents
</li></ul></li><li>Modify libuser to become a compatibility layer on top of the Rich API/dbus responder
</li><li>Test and implement Root only access to files, and channel all access through sssd
<ul><li>Needed for openshift and similar containerized envs.
</li></ul></li></ul><h3 id="Authors">Authors</h3>
<ul><li>Simo Sorce &lt;<a class="mail-link" href="mailto:ssorce@redhat.com"><span class="icon">​</span>ssorce@redhat.com</a>&gt;
</li></ul></body></html>