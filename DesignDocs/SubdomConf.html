<html><head><link rel="stylesheet" href="/sssd-test2/trac.css" type="text/css" /><link rel="stylesheet" href="/sssd-test2/wiki.css" type="text/css" /></head><body><h1 id="Subdomainconfiguration">Subdomain configuration</h1>
<p>
Related ticket(s):
</p>
<ul><li><a class="ext-link" href="https://fedorahosted.org/sssd/ticket/2599"><span class="icon">​</span>https://fedorahosted.org/sssd/ticket/2599</a>
</li></ul><h3 id="Problemstatement">Problem statement</h3>
<p>
When SSSD is joined to a FreeIPA/Active Directory domain, Administrator can easily configure/tweak the domain settings in <tt>sssd.conf</tt>. However, when SSSD is joined to a FreeIPA domain that is in a trust relationship with other domain (Active Directory), Administrator can only tweak the main (FreeIPA) domain, but cannot tweak the trusted (Active Directory) domain as it does not have a proper domain section in <tt>sssd.conf</tt>. While we introduced <tt>subdomain_inherit</tt> option which worked for some use cases, it does not help if the subdomain needs parameters different from the main domain.
</p>
<p>
This design page describes new feature that allows admins to configure subdomain parameters in standard SSSD configuration files in similar way as the main domain's parameters.
</p>
<h3 id="Usecases">Use cases</h3>
<h4 id="UseCase1:filteringinactiveusersintrustedADdomain">Use Case 1: filtering inactive users in trusted AD domain</h4>
<p>
As an Administrator, I want to set a different search base for users and groups in the trusted AD domain, to filter out users from inactive organizational units, so that only active users and groups are visible to the system.
</p>
<h4 id="UseCase2:restrictingFreeIPASSSDonlytoselectedADserversandorsites">Use Case 2: restricting FreeIPA/SSSD only to selected AD servers and/or sites</h4>
<p>
As an Administrator, I want to disable autodiscovery of AD servers and sites in the trusted AD domain and instead list servers and/or sites manually, so that I can limit the list of Active Directories SSSD communicates with and for example avoid reaching out to sites that are not accessible.
</p>
<h3 id="Overviewofthesolution">Overview of the solution</h3>
<p>
A new section in SSSD configuration will be added where the subdomain options can be set.
</p>
<p>
This section name will be the same as the main domain section with "/&lt;subdomain name&gt;" suffix, where the <tt>&lt;subdomain name&gt;</tt> is the trusted domain's name. For example if the main domain's (FreeIPA) name is <tt>ipadomain.test</tt> and the trusted (Active Directory) domain's name is <tt>addomain.test</tt>, then the configuration sections will look like this
</p>
<pre class="wiki">[domain/ipadomain.test]
# this is the main domain section

[domain/ipadomain.test/addomain.test]
# this is the trusted domain section
</pre><p>
Note that <strong>not all options available for the main domain will also be available in the new subdomain section</strong>. Here are some options that will be supported (the list is not exhaustive):
</p>
<ul><li>ldap_search_base
</li><li>ldap_user_search_base
</li><li>ldap_group_search_base
</li><li>ad_server
</li><li>ad_backup_server
</li><li>ad_site
</li></ul><h3 id="Implementationdetails">Implementation details</h3>
<p>
TBD
</p>
<h3 id="HowToTest">How To Test</h3>
<ul><li>Configure FreeIPA server and set it in a Trust relationship with respective Active Directory domain
</li><li>In <tt>sssd.conf</tt> on the FreeIPA server, add trusted domain section and redefine some of the supported options for this section (for example <tt>ldap_user_search_base</tt> for <a href="https://fedorahosted.org/sssd#Use Case 1: filtering inactive users in trusted AD domain">Use Case 1</a> or <tt>ad_server</tt>/<tt>ad_site</tt> for <a href="https://fedorahosted.org/sssd#Use Case 2: restricting FreeIPA/SSSD only to selected AD servers and/or sites">Use Case 2</a>)
</li><li>Restart SSSD
</li><li>Join FreeIPA domain with another client (with <tt>ipa-client-install</tt> for example), see if the set option is used correctly
</li></ul><h3 id="HowToDebug">How To Debug</h3>
<p>
TBD
</p>
<h3 id="Authors">Authors</h3>
<p>
Michal Židek <a class="mail-link" href="mailto:mzidek@redhat.com"><span class="icon">​</span>mzidek@redhat.com</a>
</p>
</body></html>