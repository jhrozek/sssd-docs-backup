<html><head><link rel="stylesheet" href="/sssd-test2/trac.css" type="text/css" /><link rel="stylesheet" href="/sssd-test2/wiki.css" type="text/css" /></head><body><h1 id="SSSDperformanceimprovementsforthe1.15release">SSSD performance improvements for the 1.15 release</h1>
<p>
Related ticket(s):
</p>
<ul><li><a class="ext-link" href="https://fedorahosted.org/sssd/ticket/XYZ"><span class="icon">â€‹</span>https://fedorahosted.org/sssd/ticket/XYZ</a>
</li></ul><h3 id="Problemstatement">Problem statement</h3>
<p>
We introduced the timestamp cache in 1.14 to help improve performance. But more work is needed to make SSSD work better in large environment.
</p>
<h3 id="Usecases">Use cases</h3>
<ol><li>As a user of a machine that contains a directory with a large number of files, each owned by a large group, I want commands like <tt>ls -l</tt> to resolve those large groups noticeably and measurably quicker than the previous version
</li><li>As an operator who is a member of several large domain groups, I want a log in to a machine to be noticeably and measurably faster than the previous version
</li></ol><h3 id="Overviewofthesolution">Overview of the solution</h3>
<p>
The most work is still needed in the LDAP provider. There we can:
</p>
<ul><li>refactor the <tt>sdap_async_groups.c</tt> module. Currently it iterates over all attribute values several times, which is really costly with a large number of attributes
</li><li>refactor the nested group processing to make sure expensive lookups (such as lookups of all members of the group, there can potentially be thousands of these) are only performed once and intermediate results are stored in-memory. 
</li><li>attempt to shortcut parsing the attributes of the entry returned from LDAP sooner. The idea behind this is that if the modifyTimestamp did not change, we can reuse the entry we already cached.
</li><li>Looking up an entry in sysdb_attrs is slow. We might want to implement a smarter way (sorted entries? Tree?)
</li></ul><p>
A separate effort with performance impact is:
</p>
<ul><li>implement a generic way to pass around intermediate results between requests in memory. Currently when transitioning between IPA and AD requests, we must write the intermediate results to the disk, which is a full transaction.
</li></ul><h3 id="Implementationdetails">Implementation details</h3>
<p>
A more technical extension of the previous section. Might include low-level details, such as C structures, function synopsis etc. In case of very trivial features (e.g a new option), this section can be merged with the previous one.
</p>
<h3 id="Configurationchanges">Configuration changes</h3>
<p>
Does your feature involve changes to configuration, like new options or options changing values? Summarize them here. There's no need to go into too many details, that's what man pages are for.
</p>
<h3 id="HowToTest">How To Test</h3>
<p>
This section should explain to a person with admin-level of SSSD understanding how this change affects run time behaviour of SSSD and how can an SSSD user test this change. If the feature is internal-only, please list what areas of SSSD are affected so that testers know where to focus.
</p>
<h3 id="HowToDebug">How To Debug</h3>
<p>
Explain how to debug this feature if something goes wrong. This section might include examples of additional commands the user might run (such as keytab or certificate sanity checks) or explain what message to look for.
</p>
<h3 id="Authors">Authors</h3>
<p>
Give credit to authors of the design in this section.
</p>
</body></html>